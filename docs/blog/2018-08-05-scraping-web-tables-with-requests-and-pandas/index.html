<!DOCTYPE html>
<html lang="en-us">
    <head>
        
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="Shreyash Agarwal - Blog">
<title>
Scraping Web Tables With Requests and Pandas - Shreyash Agarwal
</title>



        
        <meta property="og:title" content="Scraping web tables with requests and pandas - Shreyash Agarwal" />
<meta property="og:type" content="website" />
<meta property="og:description" content="Shreyash Agarwal - Blog"/>
<meta property="og:url" content="http://example.com/blog/2018-08-05-scraping-web-tables-with-requests-and-pandas/"/>
<meta property="og:site_name" content="Shreyash Agarwal"/>




<meta property="og:image" content="http://example.com/home/profile.png"/>




        
<link rel="shortcut icon" href="/img/fav.ico">


        





<link rel="stylesheet" href="/css/main.min.912c712459f193c9f111a0f4fe4ba8074edafb7127a95a82109d48a8daa8d805.css" integrity="sha256-kSxxJFnxk8nxEaD0/kuoB07a&#43;3EnqVqCEJ1IqNqo2AU=" crossorigin="anonymous" media="screen">





        
        
        
        
    </head>
    <body>
        <section id="top" class="section">
            
            <div class="container hero ">
                

<h1 class="bold-title is-1">Blog</h1>


            </div>
            
            <div class="section ">
                
<div class="container">
    <hr>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbar-menu " id="navMenu">
            
            
            
            
            <a class="navbar-item" href="/">
                
                Home
                
            </a>
            
            
            
            <a class="navbar-item" href="/#about">
                
                About
                
            </a>
            
            
            
            <a class="navbar-item" href="/blog/">
                
                Blog
                
            </a>
            
            
            
            <a class="navbar-item" href="pdfs/ShreyashAgarwal-Resume.pdf">
                
                Resume
                
            </a>
            
            
            
            <a class="navbar-item" href="pdfs/ShreyashAgarwal-CV.pdf">
                
                CV
                
            </a>
            
            
            
        </div>
    </nav>
    <hr>
</div>



                
<div class="container">
    <h2 class="title is-1 top-pad strong-post-title">
        <a href="http://example.com/blog/2018-08-05-scraping-web-tables-with-requests-and-pandas/">Scraping web tables with requests and pandas</a>
    </h2>
    <div class="post-data">
        Aug 5, 2018 |
        2 minutes read
    </div>
    
    <div class="blog-share">
        Share this:
        
        <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Scraping%20web%20tables%20with%20requests%20and%20pandas%20http%3a%2f%2fexample.com%2fblog%2f2018-08-05-scraping-web-tables-with-requests-and-pandas%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fab fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>
        
        
        <a class="icon-linkedin" href="https://www.linkedin.com/sharer/sharer.php?u=http%3a%2f%2fexample.com%2fblog%2f2018-08-05-scraping-web-tables-with-requests-and-pandas%2f" onclick="window.open(this.href, 'linkedin-share','width=580,height=296');return false;">
            <i class="fab fa-linkedin"></i>
            <span class="hidden">LinkedIn</span>
        </a>
        
        
        
    </div>
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
</div>

<div class="container markdown top-pad">
    <p>Hey everyone,</p>
<p>It&rsquo;s been a long time since I posted something, I&rsquo;ve been busy with work and other things.
I&rsquo;ve written a lot of scrapes recently and while trying to reduce the code I would have to write, I stumbled upon something.</p>
<p>Have you heard about <a href="https://pandas.pydata.org/">Pandas</a></p>
<p>It&rsquo;s a fantastic library which not only is useful for maintaining data structures in it&rsquo;s famous Dataframe, but also helped me cut out BeautifulSoup (another awesome library which I used to use for web parsing) completely!</p>
<p>Now I just have to use requests and a one-liner from Pandas to read html tables.</p>
<p>Don&rsquo;t believe me?
Let&rsquo;s do this then!</p>
<p>Here&rsquo;s the website from which we want the data table.<br/>
<a href="https://www.w3schools.com/html/html_tables.asp">W3 Schools HTML Tables</a></p>
<p>And this is how we can convert the web html table into a usable list of python dictionaries-</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">requests</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">pandas</span>

page <span style="color:#666">=</span> requests<span style="color:#666">.</span>get(<span style="color:#4070a0">&#39;https://www.w3schools.com/html/html_tables.asp&#39;</span>)
table_records <span style="color:#666">=</span> pandas<span style="color:#666">.</span>read_html(url, parse_dates<span style="color:#666">=</span>[<span style="color:#4070a0">&#39;&#39;</span>], <span style="color:#007020">id</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;customers&#39;</span>)[<span style="color:#40a070">0</span>]<span style="color:#666">.</span>to_dict(<span style="color:#4070a0">&#39;records&#39;</span>)
</code></pre></div><p>Yup, that&rsquo;s it!</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">print</span>(<span style="color:#666">*</span>table_records, sep<span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0;font-weight:bold">\n</span><span style="color:#4070a0">&#39;</span>)
</code></pre></div><p>Here&rsquo;s the output.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#666">{</span><span style="color:#4070a0">&#39;Company&#39;</span>: <span style="color:#4070a0">&#39;Alfreds Futterkiste&#39;</span>, <span style="color:#4070a0">&#39;Contact&#39;</span>: <span style="color:#4070a0">&#39;Maria Anders&#39;</span>, <span style="color:#4070a0">&#39;Country&#39;</span>: <span style="color:#4070a0">&#39;Germany&#39;</span><span style="color:#666">}</span>
<span style="color:#666">{</span><span style="color:#4070a0">&#39;Company&#39;</span>: <span style="color:#4070a0">&#39;Centro comercial Moctezuma&#39;</span>, <span style="color:#4070a0">&#39;Contact&#39;</span>: <span style="color:#4070a0">&#39;Francisco Chang&#39;</span>, <span style="color:#4070a0">&#39;Country&#39;</span>: <span style="color:#4070a0">&#39;Mexico&#39;</span><span style="color:#666">}</span>
<span style="color:#666">{</span><span style="color:#4070a0">&#39;Company&#39;</span>: <span style="color:#4070a0">&#39;Ernst Handel&#39;</span>, <span style="color:#4070a0">&#39;Contact&#39;</span>: <span style="color:#4070a0">&#39;Roland Mendel&#39;</span>, <span style="color:#4070a0">&#39;Country&#39;</span>: <span style="color:#4070a0">&#39;Austria&#39;</span><span style="color:#666">}</span>
<span style="color:#666">{</span><span style="color:#4070a0">&#39;Company&#39;</span>: <span style="color:#4070a0">&#39;Island Trading&#39;</span>, <span style="color:#4070a0">&#39;Contact&#39;</span>: <span style="color:#4070a0">&#39;Helen Bennett&#39;</span>, <span style="color:#4070a0">&#39;Country&#39;</span>: <span style="color:#4070a0">&#39;UK&#39;</span><span style="color:#666">}</span>
<span style="color:#666">{</span><span style="color:#4070a0">&#39;Company&#39;</span>: <span style="color:#4070a0">&#39;Laughing Bacchus Winecellars&#39;</span>, <span style="color:#4070a0">&#39;Contact&#39;</span>: <span style="color:#4070a0">&#39;Yoshi Tannamuri&#39;</span>, <span style="color:#4070a0">&#39;Country&#39;</span>: <span style="color:#4070a0">&#39;Canada&#39;</span><span style="color:#666">}</span>
<span style="color:#666">{</span><span style="color:#4070a0">&#39;Company&#39;</span>: <span style="color:#4070a0">&#39;Magazzini Alimentari Riuniti&#39;</span>, <span style="color:#4070a0">&#39;Contact&#39;</span>: <span style="color:#4070a0">&#39;Giovanni Rovelli&#39;</span>, <span style="color:#4070a0">&#39;Country&#39;</span>: <span style="color:#4070a0">&#39;Italy&#39;</span><span style="color:#666">}</span>

</code></pre></div><p>If you noticed, there&rsquo;s a dateparser incorporated into the function call, that will automatically parse strified dates into a nice and convinient pandas Timestamp.</p>
<p>To get a python date object, we just need to call a .date() method on the Timestamp object.</p>
<p>Here is a clearer use of this with a function call -</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">requests</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">pandas</span>


<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">read_html_table</span>(url, table_id):
    response <span style="color:#666">=</span> requests<span style="color:#666">.</span>get(url<span style="color:#666">=</span>url)
    table_records <span style="color:#666">=</span> pandas<span style="color:#666">.</span>read_html(io<span style="color:#666">=</span>response<span style="color:#666">.</span>text, header<span style="color:#666">=</span><span style="color:#40a070">0</span>, attrs<span style="color:#666">=</span>{
        <span style="color:#4070a0">&#39;id&#39;</span>: table_id})[<span style="color:#40a070">0</span>]<span style="color:#666">.</span>to_dict(<span style="color:#4070a0">&#39;records&#39;</span>)
    <span style="color:#007020;font-weight:bold">return</span> table_records


<span style="color:#007020;font-weight:bold">if</span> __name__ <span style="color:#666">==</span> <span style="color:#4070a0">&#34;__main__&#34;</span>:
    url <span style="color:#666">=</span> <span style="color:#4070a0">&#39;https://www.w3schools.com/html/html_tables.asp&#39;</span>
    <span style="color:#007020">id</span> <span style="color:#666">=</span> <span style="color:#4070a0">&#39;customers&#39;</span>
    table_records <span style="color:#666">=</span> read_html_table(url<span style="color:#666">=</span>url, table_id<span style="color:#666">=</span><span style="color:#007020">id</span>)
    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#666">*</span>table_records, sep<span style="color:#666">=</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0;font-weight:bold">\n</span><span style="color:#4070a0">&#39;</span>)

</code></pre></div><p>Using this method has greatly cut down on the amount of time and code that would be used to scrape a similar table using BeautifulSoup.</p>
<p>Any comments? Ideas on how this could be even better? Hit me up on twitter @shreyash_ag!</p>

</div>


<div class="container flex">
    <div class="">
        
        Previously, <a href="http://example.com/blog/2019-05-24-docker-walkthrough/">A simple Docker walkthrough</a> on 2019-05-24 00:00:00 &#43;0000 UTC
        
    </div>
    
    <div>
        
        Next, <a href="http://example.com/blog/2018-04-09-pointers-for-python/">Pointers for Pipenv</a> on 2018-04-09 00:00:00 &#43;0000 UTC
        
    </div>
</div>






                
                <div class="container">
    <hr>
</div>
<div class="container has-text-centered top-pad">
    <a href="#top">
        <i class="fa fa-arrow-up"></i>
    </a>
</div>

<div class="container">
    <hr>
</div>

                <div class="section" id="footer">
    <div class="container has-text-centered">
    
        Thanks for visiting! This page is powered by Hugo and Introduction theme.
    
    </div>
</div>

                
            </div>
        </section>
        
        


<script src="http://example.com/js/bundle.f1741e9868b2f697e71cf8fccfcc12166540999b3d36f8fb9edd0882ba425d55.js" integrity="sha256-8XQemGiy9pfnHPj8z8wSFmVAmZs9Nvj7nt0IgrpCXVU="></script>






        
        
        
        
    </body>
</html>
